
SELECT m.MODULE_TITLE, MAX(a.ASSESSMENT_ID) AS LATEST_ASSESSMENT
FROM MODULE m
JOIN ASSESSMENT a ON m.MODULE_ID = a.MODULE_ID
WHERE a.ASSESSMENT_DEADLINE = (
    SELECT MAX(ASSESSMENT_DEADLINE) 
    FROM ASSESSMENT
)
GROUP BY m.MODULE_TITLE;


SELECT * FROM (
    SELECT s.STUDENT_NAME, SUM(r.RESULT_MARKS) AS TOTAL_SCORE
    FROM STUDENT s
    JOIN RESULT r ON s.STUDENT_ID = r.STUDENT_ID
    GROUP BY s.STUDENT_NAME
    ORDER BY TOTAL_SCORE DESC
)
WHERE ROWNUM <= 3;


SELECT p.PROGRAM_TITLE, COUNT(a.ASSESSMENT_ID) AS TOTAL_ASSESSMENTS, AVG(r.RESULT_MARKS) AS AVG_SCORE
FROM PROGRAM p
JOIN STUDENT s ON p.PROGRAM_ID = s.PROGRAM_ID
JOIN ASSESSMENT_RESULT ar ON s.STUDENT_ID = ar.STUDENT_ID
JOIN RESULT r ON ar.RESULT_ID = r.RESULT_ID
JOIN ASSESSMENT a ON ar.ASSESSMENT_ID = a.ASSESSMENT_ID
GROUP BY p.PROGRAM_TITLE;




SELECT s.STUDENT_NAME
FROM STUDENT s
JOIN RESULT r ON s.STUDENT_ID = r.STUDENT_ID
JOIN ASSESSMENT a ON r.ASSESSMENT_ID = a.ASSESSMENT_ID
WHERE a.MODULE_ID = 2009 
AND r.RESULT_MARKS > (
    SELECT AVG(r2.RESULT_MARKS)
    FROM RESULT r2
    JOIN ASSESSMENT a2 ON r2.ASSESSMENT_ID = a2.ASSESSMENT_ID
    WHERE a2.MODULE_ID = 2009
);


SELECT s.STUDENT_NAME, 
       CASE WHEN SUM(r.RESULT_MARKS) >= 40 THEN 'Pass' ELSE 'Fail' END AS REMARKS
FROM STUDENT s
JOIN RESULT r ON s.STUDENT_ID = r.STUDENT_ID
JOIN ASSESSMENT a ON r.ASSESSMENT_ID = a.ASSESSMENT_ID
WHERE a.MODULE_ID = 2002
GROUP BY s.STUDENT_NAME;


